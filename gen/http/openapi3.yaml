openapi: 3.0.3
info:
  title: REST api for simple route app
  version: "1.0"
servers:
  - url: /
    description: Default server for rest-api
paths:
  /api/admin/driver:
    post:
      tags:
        - admin_service
      summary: add_manager admin_service
      description: admins could add drivers from main system
      operationId: admin_service#add_manager
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddManagerRequestBody'
            example:
              login: Repellendus odit culpa.
              password: 51n
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Quibusdam sapiente.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json:
              schema:
                type: string
                example: Eveniet perferendis omnis ullam laboriosam maxime.
        "403":
          description: 'invalid-scopes: Forbidden response.'
          content:
            application/json:
              schema:
                type: string
                example: Est dignissimos veniam est pariatur.
        "404":
          description: 'user not found: Not Found response.'
          content:
            application/json:
              schema:
                type: string
                example: Quidem sed laudantium deleniti doloribus nihil voluptas.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/admin/driver/{manager_id}:
    delete:
      tags:
        - admin_service
      summary: drop_manager admin_service
      description: admins could delete managers from main system
      operationId: admin_service#drop_manager
      parameters:
        - name: manager_id
          in: path
          description: id менеджера, которого необходимо удалить
          required: true
          schema:
            type: string
            description: id менеджера, которого необходимо удалить
            example: 773F4E7F-A748-DF6D-4355-233071D2534A
            format: uuid
          example: 5E3B665E-1239-9C12-9643-FFC1E6C04697
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Sunt sunt dolorem aliquid itaque nihil.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json:
              schema:
                type: string
                example: Veniam ipsum iusto necessitatibus.
        "403":
          description: 'invalid-scopes: Forbidden response.'
          content:
            application/json:
              schema:
                type: string
                example: Assumenda eum possimus consequatur.
        "404":
          description: 'user not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: Internal Server Error response.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/profile:
    get:
      tags:
        - auth_service
      summary: profile auth_service
      description: get user profile
      operationId: auth_service#profile
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Qui omnis natus voluptatum in est.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'user not found: Not Found response.'
          content:
            application/json:
              schema:
                type: string
                example: Necessitatibus non.
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Rerum veniam dolorem perspiciatis.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/signin:
    post:
      tags:
        - auth_service
      summary: signin auth_service
      description: Creates a valid JWT
      operationId: auth_service#signin
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Creds'
              example:
                jwt: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Dolorem aut laboriosam quia.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json:
              schema:
                type: string
                example: Mollitia laudantium porro consectetur non dolorum.
        "404":
          description: 'user not found: Not Found response.'
          content:
            application/json:
              schema:
                type: string
                example: Nobis et ab quod.
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Odio fugiat maiores.
      security:
        - basic_header_Authorization: []
  /api/tasks/:
    get:
      tags:
        - tasks_service
      summary: list tasks tasks_service
      description: получить все задачи для текущего пользователя
      operationId: tasks_service#list tasks
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Nulla et vitae nostrum.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Cumque quo non id quia sunt voluptatem.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/:
    get:
      tags:
        - tasks_service
      summary: get task tasks_service
      description: получить задачу по id
      operationId: tasks_service#get task
      parameters:
        - name: task_id
          in: path
          description: id задачи
          required: true
          schema:
            type: string
            description: id задачи
            example: Aut voluptates modi.
          example: Repudiandae maxime tenetur.
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Fuga aut laboriosam magni.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Nobis eos et inventore officiis et.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/assign:
    post:
      tags:
        - tasks_service
      summary: assign proxies tasks_service
      description: присвоить ботам прокси
      operationId: tasks_service#assign proxies
      parameters:
        - name: task_id
          in: path
          description: id задачи
          required: true
          schema:
            type: string
            description: id задачи
            example: Autem ea voluptatum voluptas et eligendi.
          example: Nihil enim architecto magni corporis.
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json: {}
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Magnam voluptatem nesciunt quaerat quasi incidunt sed.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/force:
    delete:
      tags:
        - tasks_service
      summary: force delete tasks_service
      description: удалить задачу и все связанные с ней сущности. Использовать только для тестов
      operationId: tasks_service#force delete
      parameters:
        - name: task_id
          in: path
          description: id задачи
          required: true
          schema:
            type: string
            description: id задачи
            example: Sunt et.
          example: Magnam cum nisi consequatur atque dolorem est.
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json: {}
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json: {}
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/start:
    post:
      tags:
        - tasks_service
      summary: start task tasks_service
      description: 'начать выполнение задачи '
      operationId: tasks_service#start task
      parameters:
        - name: task_id
          in: path
          description: id задачи
          required: true
          schema:
            type: string
            description: id задачи
            example: Tenetur qui.
          example: Tempore et.
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json: {}
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Labore culpa reiciendis quos unde voluptate.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/stop:
    post:
      tags:
        - tasks_service
      summary: stop task tasks_service
      description: 'остановить выполнение задачи '
      operationId: tasks_service#stop task
      parameters:
        - name: task_id
          in: path
          description: id задачи
          required: true
          schema:
            type: string
            description: id задачи
            example: Quia ratione autem minima ea esse.
          example: Dolores quo molestias.
      responses:
        "200":
          description: OK response.
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json: {}
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json: {}
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json: {}
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Assumenda quae non.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/{task_id}/upload:
    post:
      tags:
        - tasks_service
      summary: upload file tasks_service
      description: загрузить файл с пользователями, прокси
      operationId: tasks_service#upload file
      parameters:
        - name: task_id
          in: path
          description: id задачи, в которую загружаем пользователей/прокси
          required: true
          schema:
            type: string
            description: id задачи, в которую загружаем пользователей/прокси
            example: Rerum nihil explicabo ipsa autem est.
          example: Similique dolorem laborum id ipsam.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/UploadFileRequestBody'
            example:
              bots:
                - line_number: 2724879934005373904
                  record:
                    - Necessitatibus deserunt eum ea.
                    - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                    - Veniam ratione culpa.
                - line_number: 2724879934005373904
                  record:
                    - Necessitatibus deserunt eum ea.
                    - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                    - Veniam ratione culpa.
                - line_number: 2724879934005373904
                  record:
                    - Necessitatibus deserunt eum ea.
                    - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                    - Veniam ratione culpa.
                - line_number: 2724879934005373904
                  record:
                    - Necessitatibus deserunt eum ea.
                    - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                    - Veniam ratione culpa.
              proxies:
                - line_number: 6373588431339295647
                  record:
                    - Est dolorem corporis fugit fugiat.
                    - Quisquam itaque nisi.
                    - Voluptatem natus.
                - line_number: 6373588431339295647
                  record:
                    - Est dolorem corporis fugit fugiat.
                    - Quisquam itaque nisi.
                    - Voluptatem natus.
              targets:
                - line_number: 4094789948831010935
                  record:
                    - Qui magni molestiae.
                    - Voluptas excepturi.
                - line_number: 4094789948831010935
                  record:
                    - Qui magni molestiae.
                    - Voluptas excepturi.
                - line_number: 4094789948831010935
                  record:
                    - Qui magni molestiae.
                    - Voluptas excepturi.
                - line_number: 4094789948831010935
                  record:
                    - Qui magni molestiae.
                    - Voluptas excepturi.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UploadError'
                example:
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
              example:
                - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                  line: 5503245593098525652
                  reason: Molestiae ad.
                  type: 2
                - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                  line: 5503245593098525652
                  reason: Molestiae ad.
                  type: 2
                - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                  line: 5503245593098525652
                  reason: Molestiae ad.
                  type: 2
                - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                  line: 5503245593098525652
                  reason: Molestiae ad.
                  type: 2
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Molestias asperiores voluptatibus asperiores fugiat ut.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UploadError'
                example:
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UploadError'
                example:
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
                  - input: Aperiam quo mollitia necessitatibus voluptatibus porro voluptatum.
                    line: 5503245593098525652
                    reason: Molestiae ad.
                    type: 2
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Minus doloremque architecto perferendis voluptas nam.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
  /api/tasks/draft:
    post:
      tags:
        - tasks_service
      summary: create task draft tasks_service
      description: создать драфт задачи
      operationId: tasks_service#create task draft
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTaskDraftRequestBody'
            example:
              post_image: Optio animi magnam suscipit doloremque.
              text_template: Veritatis esse earum aliquid rerum.
              title: Illo aut non sint alias.
      responses:
        "200":
          description: OK response.
          content:
            application/json:
              schema:
                type: string
                description: task_id для созданной задачи
                example: 74C53540-E974-ABFF-2565-6BF99F9017B2
                format: uuid
              example: 1265498D-5A84-134A-1C7A-ED5B4B92788E
        "400":
          description: 'bad request: Bad Request response.'
          content:
            application/json:
              schema:
                type: string
                example: Et omnis distinctio tenetur et.
        "401":
          description: 'unauthorized: Unauthorized response.'
          content:
            application/json:
              schema:
                type: string
                description: task_id для созданной задачи
                example: 2C91774A-6D4A-67B6-DC43-6AED849DACC1
                format: uuid
        "404":
          description: 'task not found: Not Found response.'
          content:
            application/json:
              schema:
                type: string
                description: task_id для созданной задачи
                example: FB1E8AC6-4FA4-C883-ED5A-54960E88F5FE
                format: uuid
        "500":
          description: 'internal error: Internal Server Error response.'
          content:
            application/json:
              schema:
                type: string
                example: Et quasi soluta ab non beatae inventore.
      security:
        - jwt_header_Authorization:
            - driver
            - admin
components:
  schemas:
    AddManagerRequestBody:
      type: object
      properties:
        login:
          type: string
          example: Similique ab.
        password:
          type: string
          example: umt
          minLength: 4
      example:
        login: Nostrum et et ea.
        password: t8i
      required:
        - login
        - password
    BotAccountRecord:
      type: object
      properties:
        line_number:
          type: integer
          description: номер строки в исходном файле
          example: 7978011091693614
          format: int64
        record:
          type: array
          items:
            type: string
            example: Velit eum voluptatem expedita itaque sint.
          example:
            - Consequatur animi quae et modi vel.
            - Repellat dolores.
            - Est exercitationem suscipit sit nisi.
          minItems: 4
          maxItems: 4
      example:
        line_number: 8333772517615629061
        record:
          - Nobis cupiditate consequatur ea atque.
          - Esse molestiae placeat.
          - Dolore perferendis esse accusantium quo maxime facilis.
      required:
        - record
        - line_number
    CreateTaskDraftRequestBody:
      type: object
      properties:
        post_image:
          type: string
          description: фотография для постов
          example: Eos ipsa eveniet et molestias molestias non.
        text_template:
          type: string
          description: шаблон для подписи под постом
          example: Blanditiis blanditiis.
        title:
          type: string
          description: название задачи
          example: Rerum consequuntur.
      example:
        post_image: Tempore occaecati fugit.
        text_template: Earum nisi et eum aliquid.
        title: Amet nemo quia est.
      required:
        - title
        - text_template
        - post_image
    Creds:
      type: object
      properties:
        jwt:
          type: string
          description: JWT token
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ
      example:
        jwt: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ
      required:
        - jwt
    UploadError:
      type: object
      properties:
        input:
          type: string
          description: номер порта
          example: Eaque qui non omnis magnam.
        line:
          type: integer
          example: 1326508170280221418
          format: int64
        reason:
          type: string
          example: Ut cum sint beatae commodi omnis explicabo.
        type:
          type: integer
          description: |2-
             1 - список ботов
                2 - список прокси
                3 - список получателей рекламы
          example: 2
          enum:
            - 1
            - 2
            - 3
      example:
        input: Sapiente atque.
        line: 5851803150507950181
        reason: Dolores nam.
        type: 2
      required:
        - type
        - line
        - input
        - reason
    UploadFileRequestBody:
      type: object
      properties:
        bots:
          type: array
          items:
            $ref: '#/components/schemas/BotAccountRecord'
          description: список ботов
          example:
            - line_number: 2724879934005373904
              record:
                - Necessitatibus deserunt eum ea.
                - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                - Veniam ratione culpa.
            - line_number: 2724879934005373904
              record:
                - Necessitatibus deserunt eum ea.
                - Adipisci quia reprehenderit repellendus est tenetur consequatur.
                - Veniam ratione culpa.
        proxies:
          type: array
          items:
            $ref: '#/components/schemas/BotAccountRecord'
          description: список проксей для использования
          example:
            - line_number: 6373588431339295647
              record:
                - Est dolorem corporis fugit fugiat.
                - Quisquam itaque nisi.
                - Voluptatem natus.
            - line_number: 6373588431339295647
              record:
                - Est dolorem corporis fugit fugiat.
                - Quisquam itaque nisi.
                - Voluptatem natus.
            - line_number: 6373588431339295647
              record:
                - Est dolorem corporis fugit fugiat.
                - Quisquam itaque nisi.
                - Voluptatem natus.
        targets:
          type: array
          items:
            $ref: '#/components/schemas/BotAccountRecord'
          description: список аккаунтов, которым показать надо рекламу
          example:
            - line_number: 4094789948831010935
              record:
                - Qui magni molestiae.
                - Voluptas excepturi.
            - line_number: 4094789948831010935
              record:
                - Qui magni molestiae.
                - Voluptas excepturi.
            - line_number: 4094789948831010935
              record:
                - Qui magni molestiae.
                - Voluptas excepturi.
            - line_number: 4094789948831010935
              record:
                - Qui magni molestiae.
                - Voluptas excepturi.
      example:
        bots:
          - line_number: 2724879934005373904
            record:
              - Necessitatibus deserunt eum ea.
              - Adipisci quia reprehenderit repellendus est tenetur consequatur.
              - Veniam ratione culpa.
          - line_number: 2724879934005373904
            record:
              - Necessitatibus deserunt eum ea.
              - Adipisci quia reprehenderit repellendus est tenetur consequatur.
              - Veniam ratione culpa.
          - line_number: 2724879934005373904
            record:
              - Necessitatibus deserunt eum ea.
              - Adipisci quia reprehenderit repellendus est tenetur consequatur.
              - Veniam ratione culpa.
          - line_number: 2724879934005373904
            record:
              - Necessitatibus deserunt eum ea.
              - Adipisci quia reprehenderit repellendus est tenetur consequatur.
              - Veniam ratione culpa.
        proxies:
          - line_number: 6373588431339295647
            record:
              - Est dolorem corporis fugit fugiat.
              - Quisquam itaque nisi.
              - Voluptatem natus.
          - line_number: 6373588431339295647
            record:
              - Est dolorem corporis fugit fugiat.
              - Quisquam itaque nisi.
              - Voluptatem natus.
          - line_number: 6373588431339295647
            record:
              - Est dolorem corporis fugit fugiat.
              - Quisquam itaque nisi.
              - Voluptatem natus.
          - line_number: 6373588431339295647
            record:
              - Est dolorem corporis fugit fugiat.
              - Quisquam itaque nisi.
              - Voluptatem natus.
        targets:
          - line_number: 4094789948831010935
            record:
              - Qui magni molestiae.
              - Voluptas excepturi.
          - line_number: 4094789948831010935
            record:
              - Qui magni molestiae.
              - Voluptas excepturi.
          - line_number: 4094789948831010935
            record:
              - Qui magni molestiae.
              - Voluptas excepturi.
      required:
        - bots
        - proxies
        - targets
  securitySchemes:
    basic_header_Authorization:
      type: http
      description: Basic authentication used to authenticate security principal during signin
      scheme: basic
    jwt_header_Authorization:
      type: http
      description: Secures endpoint by requiring a valid JWT token retrieved via the signin endpoint. Supports scopes "api:read" and "api:write".
      scheme: bearer
tags:
  - name: admin_service
    description: The secured service exposes endpoints that require valid authorization credentials.
  - name: auth_service
    description: The secured service exposes endpoints that require valid authorization credentials.
  - name: tasks_service
    description: сервис для создания, редактирования и работы с задачами (рекламными компаниями)
